<!DOCTYPE html>
<html>
<head>
<title>Pub/Sub Local Demo</title>
<script src="https://cdn.jsdelivr.net/npm/@google-cloud/pubsub@latest/build/bundles/google-cloud-pubsub.min.js"></script>
<script>
  // Replace with your actual project ID and subscription name
  const projectId = 'your-project-id';
  const subscriptionName = 'your-subscription-name';

  const pubsub = new PubSub({ projectId });
  const subscription = pubsub.subscription(subscriptionName);

  function displayMessage(message) {
    // Decode the message data from base64
    const data = JSON.parse(Buffer.from(message.data, 'base64').toString());

    // Create a new paragraph element for the message
    const messageElement = document.createElement('p');
    messageElement.textContent = `Received: ${JSON.stringify(data)}`;

    // Append the message to the corresponding text box
    document.getElementById('messageBox').appendChild(messageElement);

    // Acknowledge the message
    message.ack();
  }

  subscription.on('message', message => {
    displayMessage(message);
  });

  function publishMessage() {
    const message = document.getElementById('publishInput').value;

    // Convert the message to a JSON object
    const data = JSON.parse(message);

    // Publish the message
    const dataBuffer = Buffer.from(JSON.stringify(data));
    pubsub.topic('your-topic-name').publish(dataBuffer);

    // Clear the input field
    document.getElementById('publishInput').value = '';
  }
</script>
</head>
<body>
  <h1>Pub/Sub Local Demo</h1>

  <h2>Received Messages:</h2>
  <div id="messageBox"></div>

  <h2>Publish Message:</h2>
  <textarea id="publishInput"></textarea>
  <button onclick="publishMessage()">Publish</button>
</body>
</html>